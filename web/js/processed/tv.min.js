function moreItems(e,t){$.ajax({type:"GET",url:t,async:!0,jsonpCallback:"callback",contentType:"application/json",dataType:"json",timeout:1e3,data:{page:e,nb:8},error:function(){console.log("error")},success:function(e){addToWall(e.items),$("a#more").attr("data-page",parseInt(e.page))}})}function addToWall(e){$(e).each(function(){var e=$("#addToWall").html(),t=Handlebars.compile(e),a=t(this);$("section.wall a#more").before(a)})}var grayscale=function(){var e={colorProps:["color","backgroundColor","borderBottomColor","borderTopColor","borderLeftColor","borderRightColor","backgroundImage"],externalImageHandler:{init:function(e,t){"img"===e.nodeName.toLowerCase()||(r(e).backgroundImageSRC=t,e.style.backgroundImage="")},reset:function(e){"img"===e.nodeName.toLowerCase()||(e.style.backgroundImage="url("+(r(e).backgroundImageSRC||"")+")")}}},t=function(){try{window.console.log.apply(console,arguments)}catch(e){}},a=function(e){return new RegExp("https?://(?!"+window.location.hostname+")").test(e)},r=function(){var e=[0],t="data"+ +new Date;return function(a){var r=a[t],n=e.length;return r||(r=a[t]=n,e[r]={}),e[r]}}(),n=function(e,t,a){var o=document.createElement("canvas"),c=o.getContext("2d"),i=e.naturalHeight||e.offsetHeight||e.height,s=e.naturalWidth||e.offsetWidth||e.width,d;o.height=i,o.width=s,c.drawImage(e,0,0);try{d=c.getImageData(0,0,s,i)}catch(u){}if(t){n.preparing=!0;var g=0;return void function(){if(n.preparing){g===i&&(c.putImageData(d,0,0,0,0,s,i),a?r(a).BGdataURL=o.toDataURL():r(e).dataURL=o.toDataURL());for(var t=0;s>t;t++){var u=4*(g*s+t);d.data[u]=d.data[u+1]=d.data[u+2]=l(d.data[u],d.data[u+1],d.data[u+2])}g++,setTimeout(arguments.callee,0)}}()}n.preparing=!1;for(var g=0;i>g;g++)for(var m=0;s>m;m++){var f=4*(g*s+m);d.data[f]=d.data[f+1]=d.data[f+2]=l(d.data[f],d.data[f+1],d.data[f+2])}return c.putImageData(d,0,0,0,0,s,i),o},o=function(e,t){var a=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(e,null)[t]:e.currentStyle[t];if(a&&/^#[A-F0-9]/i.test(a)){var r=a.match(/[A-F0-9]{2}/gi);a="rgb("+parseInt(r[0],16)+","+parseInt(r[1],16)+","+parseInt(r[2],16)+")"}return a},l=function(e,t,a){return parseInt(.2125*e+.7154*t+.0721*a,10)},c=function(e){var t=Array.prototype.slice.call(e.getElementsByTagName("*"));return t.unshift(e),t},i=function(t){if(t&&t[0]&&t.length&&t[0].nodeName)for(var s=Array.prototype.slice.call(t),d=-1,u=s.length;++d<u;)i.call(this,s[d]);else{if(t=t||document.documentElement,!document.createElement("canvas").getContext)return t.style.filter="progid:DXImageTransform.Microsoft.BasicImage(grayscale=1)",void(t.style.zoom=1);for(var g=c(t),m=-1,f=g.length;++m<f;){var p=g[m];if("img"===p.nodeName.toLowerCase()){var v=p.getAttribute("src");if(!v)continue;if(a(v))e.externalImageHandler.init(p,v);else{r(p).realSRC=v;try{p.src=r(p).dataURL||n(p).toDataURL()}catch(h){e.externalImageHandler.init(p,v)}}}else for(var y=0,I=e.colorProps.length;I>y;y++){var b=e.colorProps[y],C=o(p,b);if(C)if(p.style[b]&&(r(p)[b]=C),"rgb("!==C.substring(0,4)){if(C.indexOf("url(")>-1){var w=/\(['"]?(.+?)['"]?\)/,x=C.match(w)[1];if(a(x)){e.externalImageHandler.init(p,x),r(p).externalBG=!0;continue}try{var L=r(p).BGdataURL||function(){var e=document.createElement("img");return e.src=x,n(e).toDataURL()}();p.style[b]=C.replace(w,function(e,t){return"("+L+")"})}catch(h){e.externalImageHandler.init(p,x)}}}else{var R=l.apply(null,C.match(/\d+/g));p.style[b]=C="rgb("+R+","+R+","+R+")"}}}}};return i.reset=function(t){if(t&&t[0]&&t.length&&t[0].nodeName)for(var n=Array.prototype.slice.call(t),o=-1,l=n.length;++o<l;)i.reset.call(this,n[o]);else{if(t=t||document.documentElement,!document.createElement("canvas").getContext)return void(t.style.filter="progid:DXImageTransform.Microsoft.BasicImage(grayscale=0)");for(var s=c(t),d=-1,u=s.length;++d<u;){var g=s[d];if("img"===g.nodeName.toLowerCase()){var m=g.getAttribute("src");a(m)&&e.externalImageHandler.reset(g,m),g.src=r(g).realSRC||m}else for(var f=0,p=e.colorProps.length;p>f;f++){r(g).externalBG&&e.externalImageHandler.reset(g);var v=e.colorProps[f];g.style[v]=r(g)[v]||""}}}},i.prepare=function(e){if(e&&e[0]&&e.length&&e[0].nodeName)for(var t=Array.prototype.slice.call(e),l=-1,s=t.length;++l<s;)i.prepare.call(null,t[l]);else if(e=e||document.documentElement,document.createElement("canvas").getContext)for(var d=c(e),u=-1,g=d.length;++u<g;){var m=d[u];if(r(m).skip)return;if("img"===m.nodeName.toLowerCase())m.getAttribute("src")&&!a(m.src)&&n(m,!0);else{var f=o(m,"backgroundImage");if(f.indexOf("url(")>-1){var p=/\(['"]?(.+?)['"]?\)/,v=f.match(p)[1];if(!a(v)){var h=document.createElement("img");h.src=v,n(h,!0,m)}}}}},i}();$(document).ready(function(){$("section.wall").on("click","a#more",function(){if($(this).attr("data-page"))var e=parseInt($(this).attr("data-page"));else var e=1;var t=$(this).attr("data-apiUrl");moreItems(e+1,t)})});